(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/releaseVideo/releaseVideo"],{"244b":function(e,o,a){"use strict";a.r(o);var t=a("2c56"),s=a("3fe4");for(var r in s)"default"!==r&&function(e){a.d(o,e,function(){return s[e]})}(r);a("bd83");var l=a("2877"),n=Object(l["a"])(s["default"],t["a"],t["b"],!1,null,null,null);o["default"]=n.exports},"2c56":function(e,o,a){"use strict";var t=function(){var e=this,o=e.$createElement;e._self._c},s=[];a.d(o,"a",function(){return t}),a.d(o,"b",function(){return s})},"3fe4":function(e,o,a){"use strict";a.r(o);var t=a("ba9c"),s=a.n(t);for(var r in t)"default"!==r&&function(e){a.d(o,e,function(){return t[e]})}(r);o["default"]=s.a},ba9c:function(e,o,a){"use strict";(function(e,t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s=function(){return a.e("components/uni-popup/uni-popup").then(a.bind(null,"73b7"))},r=(getApp(),{components:{uniPopup:s},data:function(){return{fileUrl:"",src:"",remnant:0,desc:"",token:[],videoUrl:"",drafts:{},show:!1,popupType:"",type:"",appUserDraftsId:"",load:""}},onLoad:function(o){var a=this;if(o.fileUrl)console.log(e(o.fileUrl," at pages\\releaseVideo\\releaseVideo.vue:73")),a.load=a.changeVideoType(o.fileUrl),a.videoUrl=o.fileUrl,a.fileName=o.src;else if(o.id){var t=this.$store.state.listVideo;t&&(console.log(e(t," at pages\\releaseVideo\\releaseVideo.vue:80")),console.log(e(t.url," at pages\\releaseVideo\\releaseVideo.vue:81")),console.log(e(t.name," at pages\\releaseVideo\\releaseVideo.vue:82")),a.load=a.changeVideoType(t.url),a.videoUrl=t.url,a.src=t.name,a.desc=t.content,a.appUserDraftsId=o.id,a.init())}},onShow:function(){},methods:{changeVideoType:function(e){return e=e.replace("MP4","jpg"),e=e.replace("mp4","jpg"),e=e.replace("flv","jpg"),e=e.replace("avi","jpg"),e=e.replace("rmvb","jpg"),e=e.replace("rm","jpg"),e=e.replace("wmv","jpg"),e=e.replace("MOV","jpg"),e=e.replace("mov","jpg"),e},init:function(){var e=this,o=this;this.draftsList=[],t.request({url:this.url+"controller/videocontroller/getappuserdrafts",method:"post",data:{type:2},header:{"content-type":"application/x-www-form-urlencoded",token:o.token,port:"app"},success:function(o){421==o.data.code&&t.navigateTo({url:"/pages/loginPhone/loginPhone"}),200==o.data.code&&(e.draftsList=o.data.data)}})},cancel:function(){return this.togglePopup("center","tip"),!0},descInput:function(e){this.remnant=e.detail.value.length},delectVideo:function(){var e=this;t.showModal({title:"提示",content:"是否要删除此视频",success:function(o){o.confirm&&(e.videoUrl="",e.load="")}})},chooseVideo:function(){var o=this.url,a=this;t.chooseVideo({count:1,sourceType:["camera","album"],success:function(s){console.log(e(s," at pages\\releaseVideo\\releaseVideo.vue:163"));var r=s.tempFilePath;console.log(e(r," at pages\\releaseVideo\\releaseVideo.vue:165")),a.src=r,t.uploadFile({url:o+"/upload",filePath:r,name:"file",formData:{user:"test"},success:function(o){console.log(e(o.data," at pages\\releaseVideo\\releaseVideo.vue:175")),o.data=JSON.parse(o.data),200==o.data.code?(a.src=o.data.data.fileName,a.videoUrl=o.data.data.fileUrl,a.load=a.changeVideoType(o.data.data.fileUrl),console.log(e(a.src," at pages\\releaseVideo\\releaseVideo.vue:181")),console.log(e(a.videoUrl," at pages\\releaseVideo\\releaseVideo.vue:182"))):console.log(e("请求异常"," at pages\\releaseVideo\\releaseVideo.vue:184"))}})}})},release:function(){var o,a=this.url,s=this.desc,r=this;console.log(e(r.videoUrl," at pages\\releaseVideo\\releaseVideo.vue:200")),t.getStorage({key:"token",success:function(e){o=e.data}}),console.log(e(o," at pages\\releaseVideo\\releaseVideo.vue:207")),t.request({url:a+"/controller/usercontroller/addshortvideo",data:{videoUrl:r.videoUrl,content:s},method:"POST",header:{"content-type":"application/x-www-form-urlencoded",port:"app",token:o},success:function(o){421==o.data.code&&t.navigateTo({url:"/pages/loginPhone/loginPhone"}),console.log(e(o," at pages\\releaseVideo\\releaseVideo.vue:227")),console.log(e(o.data.code," at pages\\releaseVideo\\releaseVideo.vue:228")),200==o.data.code?t.switchTab({url:"/pages/user/user"}):console.log(e("请求异常"," at pages\\releaseVideo\\releaseVideo.vue:234"))}})},save:function(){var o,a=this.url,s=this.desc,r=this.src,l=this;console.log(e(l.src," at pages\\releaseVideo\\releaseVideo.vue:247")),t.getStorage({key:"token",success:function(e){o=e.data}}),console.log(e(o," at pages\\releaseVideo\\releaseVideo.vue:254"));var n=[{content:s,videoName:l.src,videoUrl:l.videoUrl}];console.log(e(n," at pages\\releaseVideo\\releaseVideo.vue:262"));var i=JSON.stringify(n),d={type:2,draftsContent:i};if(this.appUserDraftsId){var c={appUserDraftsId:l.appUserDraftsId,draftsContent:i};console.log(e(c," at pages\\releaseVideo\\releaseVideo.vue:273")),console.log(e(r," at pages\\releaseVideo\\releaseVideo.vue:274")),t.request({url:a+"/controller/videocontroller/updateappuserdrafts",data:c,method:"POST",header:{"content-type":"application/x-www-form-urlencoded",port:"app",token:o},success:function(o){421==o.data.code&&t.navigateTo({url:"/pages/loginPhone/loginPhone"}),console.log(e(o," at pages\\releaseVideo\\releaseVideo.vue:290")),console.log(e(o.data.code," at pages\\releaseVideo\\releaseVideo.vue:291")),200==o.data.code?t.navigateTo({url:"/pages/drafts/drafts"}):console.log(e("请求异常"," at pages\\releaseVideo\\releaseVideo.vue:297"))}})}else t.request({url:a+"/controller/videocontroller/addappuserdrafts",data:d,method:"POST",header:{"content-type":"application/x-www-form-urlencoded",port:"app",token:o},success:function(o){421==o.data.code&&t.navigateTo({url:"/pages/loginPhone/loginPhone"}),console.log(e(o.data.code," at pages\\releaseVideo\\releaseVideo.vue:317")),200==o.data.code?t.navigateTo({url:"/pages/drafts/drafts"}):console.log(e("请求异常"," at pages\\releaseVideo\\releaseVideo.vue:323"))}})},togglePopup:function(e,o){switch(e){case"top":this.content="顶部弹出 popup";break;case"bottom":this.content="底部弹出 popup";break;case"center":this.content="居中弹出 popup";break}this.popupType=e,"tip"===o?this.show=!0:this.$refs[o].open()},cancelPopup:function(e){"tip"===e&&t.navigateBack(),"skip"===e&&this.save()}}});o.default=r}).call(this,a("0de9")["default"],a("6e42")["default"])},bd83:function(e,o,a){"use strict";var t=a("fcf4"),s=a.n(t);s.a},e023:function(e,o,a){"use strict";(function(e){a("19df"),a("921b");t(a("66fd"));var o=t(a("244b"));function t(e){return e&&e.__esModule?e:{default:e}}e(o.default)}).call(this,a("6e42")["createPage"])},fcf4:function(e,o,a){}},[["e023","common/runtime","common/vendor"]]]);