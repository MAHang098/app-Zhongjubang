(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/releaseVideo/releaseVideo"],{"2a96":function(e,o,a){"use strict";var t=function(){var e=this,o=e.$createElement;e._self._c},s=[];a.d(o,"a",function(){return t}),a.d(o,"b",function(){return s})},"6cc4":function(e,o,a){"use strict";a.r(o);var t=a("7324"),s=a.n(t);for(var r in t)"default"!==r&&function(e){a.d(o,e,function(){return t[e]})}(r);o["default"]=s.a},"6e8b":function(e,o,a){"use strict";a.r(o);var t=a("2a96"),s=a("6cc4");for(var r in s)"default"!==r&&function(e){a.d(o,e,function(){return s[e]})}(r);a("7233");var n=a("2877"),l=Object(n["a"])(s["default"],t["a"],t["b"],!1,null,null,null);o["default"]=l.exports},7233:function(e,o,a){"use strict";var t=a("9c2e"),s=a.n(t);s.a},7324:function(e,o,a){"use strict";(function(e,t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s=function(){return a.e("components/uni-popup/uni-popup").then(a.bind(null,"0aab"))},r={components:{uniPopup:s},data:function(){return{fileUrl:"",src:"",remnant:0,desc:"",token:[],videoUrl:"",drafts:{},show:!1,popupType:"",type:"",appUserDraftsId:""}},onLoad:function(o){var a=this;if(o.fileUrl)console.log(e(o.fileUrl," at pages/releaseVideo/releaseVideo.vue:68")),a.videoUrl=o.fileUrl,a.fileName=o.src;else if(o.id){var t=this.$store.state.listVideo;t&&(console.log(e(t," at pages/releaseVideo/releaseVideo.vue:74")),console.log(e(t.url," at pages/releaseVideo/releaseVideo.vue:75")),console.log(e(t.name," at pages/releaseVideo/releaseVideo.vue:76")),a.videoUrl=t.url,a.src=t.name,a.desc=t.content,a.appUserDraftsId=o.id,a.init())}},onShow:function(){},methods:{init:function(){var e=this,o=this;this.draftsList=[],t.request({url:this.url+"controller/videocontroller/getappuserdrafts",method:"post",data:{type:2},header:{"content-type":"application/x-www-form-urlencoded",token:o.token,port:"app"},success:function(o){421==o.data.code&&t.navigateTo({url:"/pages/loginPhone/loginPhone"}),200==o.data.code&&(e.draftsList=o.data.data)}})},cancel:function(){return this.togglePopup("center","tip"),!0},descInput:function(e){this.remnant=e.detail.value.length},delectVideo:function(){var e=this;t.showModal({title:"提示",content:"是否要删除此视频",success:function(o){o.confirm&&(e.videoUrl="")}})},chooseVideo:function(){var o=this.url,a=this;t.chooseVideo({count:1,sourceType:["camera","album"],success:function(s){console.log(e(s," at pages/releaseVideo/releaseVideo.vue:143"));var r=s.tempFilePath;console.log(e(r," at pages/releaseVideo/releaseVideo.vue:145")),a.src=r,t.uploadFile({url:o+"/upload",filePath:r,name:"file",formData:{user:"test"},success:function(o){console.log(e(o.data," at pages/releaseVideo/releaseVideo.vue:155")),o.data=JSON.parse(o.data),200==o.data.code?(a.src=o.data.data.fileName,a.videoUrl=o.data.data.fileUrl,console.log(e(a.src," at pages/releaseVideo/releaseVideo.vue:160")),console.log(e(a.videoUrl," at pages/releaseVideo/releaseVideo.vue:161"))):console.log(e("请求异常"," at pages/releaseVideo/releaseVideo.vue:163"))}})}})},release:function(){var o,a=this.url,s=this.desc,r=this;console.log(e(r.videoUrl," at pages/releaseVideo/releaseVideo.vue:179")),t.getStorage({key:"token",success:function(e){o=e.data}}),console.log(e(o," at pages/releaseVideo/releaseVideo.vue:186")),t.request({url:a+"/controller/usercontroller/addshortvideo",data:{videoUrl:r.videoUrl,content:s},method:"POST",header:{"content-type":"application/x-www-form-urlencoded",port:"app",token:o},success:function(o){421==o.data.code&&t.navigateTo({url:"/pages/loginPhone/loginPhone"}),console.log(e(o," at pages/releaseVideo/releaseVideo.vue:206")),console.log(e(o.data.code," at pages/releaseVideo/releaseVideo.vue:207")),200==o.data.code?t.switchTab({url:"/pages/user/user"}):console.log(e("请求异常"," at pages/releaseVideo/releaseVideo.vue:213"))}})},save:function(){var o,a=this.url,s=this.desc,r=this.src,n=this;console.log(e(n.src," at pages/releaseVideo/releaseVideo.vue:226")),t.getStorage({key:"token",success:function(e){o=e.data}}),console.log(e(o," at pages/releaseVideo/releaseVideo.vue:233"));var l=[{content:s,videoName:n.src,videoUrl:n.videoUrl}];console.log(e(l," at pages/releaseVideo/releaseVideo.vue:241"));var i=JSON.stringify(l),d={type:2,draftsContent:i};if(this.appUserDraftsId){var c={appUserDraftsId:n.appUserDraftsId,draftsContent:i};console.log(e(c," at pages/releaseVideo/releaseVideo.vue:252")),console.log(e(r," at pages/releaseVideo/releaseVideo.vue:253")),t.request({url:a+"/controller/videocontroller/updateappuserdrafts",data:c,method:"POST",header:{"content-type":"application/x-www-form-urlencoded",port:"app",token:o},success:function(o){421==o.data.code&&t.navigateTo({url:"/pages/loginPhone/loginPhone"}),console.log(e(o," at pages/releaseVideo/releaseVideo.vue:269")),console.log(e(o.data.code," at pages/releaseVideo/releaseVideo.vue:270")),200==o.data.code?t.navigateTo({url:"/pages/drafts/drafts"}):console.log(e("请求异常"," at pages/releaseVideo/releaseVideo.vue:276"))}})}else t.request({url:a+"/controller/videocontroller/addappuserdrafts",data:d,method:"POST",header:{"content-type":"application/x-www-form-urlencoded",port:"app",token:o},success:function(o){421==o.data.code&&t.navigateTo({url:"/pages/loginPhone/loginPhone"}),console.log(e(o.data.code," at pages/releaseVideo/releaseVideo.vue:296")),200==o.data.code?t.navigateTo({url:"/pages/drafts/drafts"}):console.log(e("请求异常"," at pages/releaseVideo/releaseVideo.vue:302"))}})},togglePopup:function(e,o){switch(e){case"top":this.content="顶部弹出 popup";break;case"bottom":this.content="底部弹出 popup";break;case"center":this.content="居中弹出 popup";break}this.popupType=e,"tip"===o?this.show=!0:this.$refs[o].open()},cancelPopup:function(e){"tip"!==e?"skip"===e&&this.save():this.show=!1}}};o.default=r}).call(this,a("0de9")["default"],a("6e42")["default"])},"9c2e":function(e,o,a){},e6c1:function(e,o,a){"use strict";(function(e){a("0497"),a("921b");t(a("66fd"));var o=t(a("6e8b"));function t(e){return e&&e.__esModule?e:{default:e}}e(o.default)}).call(this,a("6e42")["createPage"])}},[["e6c1","common/runtime","common/vendor"]]]);