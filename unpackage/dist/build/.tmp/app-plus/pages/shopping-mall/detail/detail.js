(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shopping-mall/detail/detail"],{"2f9a":function(t,e,o){},6709:function(t,e,o){"use strict";(function(t){o("19df"),o("921b");n(o("66fd"));var e=n(o("75cd"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("6e42")["createPage"])},"75cd":function(t,e,o){"use strict";o.r(e);var n=o("e2a9"),i=o("e42a");for(var a in i)"default"!==a&&function(t){o.d(e,t,function(){return i[t]})}(a);o("7851");var s=o("2877"),c=Object(s["a"])(i["default"],n["a"],n["b"],!1,null,null,null);e["default"]=c.exports},7851:function(t,e,o){"use strict";var n=o("2f9a"),i=o.n(n);i.a},"7ddf":function(t,e,o){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){return o.e("components/uni-popup/uni-popup").then(o.bind(null,"73b7"))},a=function(){return o.e("components/uni-swiper-stop/uni-swiper-stop").then(o.bind(null,"5c2b"))},s={components:{uniPopup:i,uniSwiperDot:a},data:function(){return{scrollFlag:!1,swiperItem:[],token:"",showExplain:!1,popupType:"",imaData:[],showPlus:!0,typeItem:["红色336*286","红色336*286","红色336*286","红色336*286"],spec_type_name:"",activeIndex:-1,detailItem:[],commentList:[],product_num:1,specificationsId:"",addType:0,recommendItem:[],detailId:"",shopItem:{},reserve:null,scolltop:0,detailType:["商品","评论","推荐","详情"],current:0,scrollTop:0,swiperCurrent:0,mode:"round",dotsStyles:{width:7,height:6,backgroundColor:"rgba(0, 0, 0,0.3)",border:"1px rgba(0, 0, 0,0) solid",color:"#fff",selectedBackgroundColor:"rgba(249,183,45,1)",selectedBorder:"1px rgba(249,183,45,1) solid"}}},filters:{ellipsis:function(t){return t?t.length>20?t.slice(0,20)+"...":t:""}},onPageScroll:function(t){var e=this;t.scrollTop>50?e.scrollFlag=!0:e.scrollFlag=!1},onLoad:function(t){this.detailId=t.id},onShow:function(){var e=this;t.getStorage({key:"token",success:function(t){e.token=t.data}}),this.init(),this.gainProductRecommend()},methods:{goShop:function(e){t.navigateTo({url:"/pages/shop-command/shop-command?id="+e})},swiperChange:function(t){this.swiperCurrent=t.detail.current},changeType:function(e){this.current=e;var o=0,n=t.createSelectorQuery().select(".explain");n.boundingClientRect(function(n){o=n.height,0==e&&t.pageScrollTo({duration:0,scrollTop:0}),1==e&&t.pageScrollTo({duration:0,scrollTop:611+o}),2==e&&t.pageScrollTo({duration:0,scrollTop:900+o}),3==e&&t.pageScrollTo({duration:0,scrollTop:1110+o})}).exec()},init:function(){var e=this;t.request({url:this.url+"controller/shopcontroller/getgoodsbyid",method:"post",data:{goodsId:this.detailId},header:{"content-type":"application/x-www-form-urlencoded",token:this.token,port:"app"},success:function(o){if(200==o.data.code){var n=[],i=o.data.data[0];e.commentList=i.goodsDiscussList,e.shopItem=i.shop,i.goodsDTO.tag=JSON.parse(i.goodsDTO.tag),e.detailItem=i.goodsDTO,e.swiperItem=i.goodsDTO.topImgList.split(",");for(var a=i.goodsDTO.goodsContent,s=/src=[\'\"]?([^\'\"]*)[\'\"]?/i,c=a.match(/<img[^>]+>/g),r=0;r<c.length;r++){var l=c[r].match(s);n.push(l[1])}e.imaData=n}else t.showToast({icon:"none",title:o.data.message}),t.hideToast()}})},gainProductRecommend:function(){var e=this;t.request({url:this.url+"controller/shopcontroller/getAppGoodsRecommendGoods",method:"post",data:{pageIndex:1,pageSize:100},header:{"content-type":"application/x-www-form-urlencoded",token:this.token,port:"app"},success:function(t){200==t.data.code&&(e.recommendItem=t.data.data.dataList)}})},explainShow:function(){this.showExplain=!this.showExplain},togglePopup:function(t,e){this.specDetail(),this.popupType=t,"tip"===e||this.$refs[e].open()},cancelPopup:function(t){this.$refs[t].close()},imgPreview:function(e,o){t.previewImage({urls:e,current:o,longPressActions:{itemList:["发送给朋友","保存图片","收藏"],success:function(t){console.log(n("选中了第"+(t.tapIndex+1)+"个按钮,第"+(t.index+1)+"张图片"," at pages\\shopping-mall\\detail\\detail.vue:380"))},fail:function(t){console.log(n(t.errMsg," at pages\\shopping-mall\\detail\\detail.vue:383"))}}})},collectShop:function(e){var o=this;t.request({url:this.url+"controller/usercontroller/addusercollection",method:"post",data:{type:"4",collectionContentId:e},header:{"content-type":"application/x-www-form-urlencoded",token:this.token,port:"app"},success:function(e){200==e.data.code&&o.init(),421==e.data.code&&t.navigateTo({url:"/pages/loginPhone/loginPhone"})}})},collectProduct:function(e){var o=this;t.showLoading({title:"加载中"}),t.request({url:this.url+"controller/usercontroller/addusercollection",method:"post",data:{type:"3",collectionContentId:e},header:{"content-type":"application/x-www-form-urlencoded",token:this.token,port:"app"},success:function(e){console.log(n(e," at pages\\shopping-mall\\detail\\detail.vue:419")),200==e.data.code&&(o.init(),t.hideLoading()),421==e.data.code&&t.navigateTo({url:"/pages/loginPhone/loginPhone"})},fail:function(e){t.showToast({title:"请求超时",icon:"none"})}})},specDetail:function(){var e=this;t.request({url:this.url+"controller/shopcontroller/getgoodsspecificationslist",method:"post",data:{goodsId:"1"},header:{"content-type":"application/x-www-form-urlencoded",token:this.token,port:"app"},success:function(o){200==o.data.code&&(e.typeItem=o.data.data),421==o.data.code&&t.navigateTo({url:"/pages/loginPhone/loginPhone"})}})},choseType:function(t,e,o,n){this.spec_type_name=t,this.reserve=n,e!=this.activeIndex?(this.activeIndex=e,this.specificationsId=o):this.activeIndex=-1},define:function(){this.cancelPopup("spec"),""!=this.spec_type_name&&(1!=this.addType?2!=this.addType||this.buy():this.addCart())},getAllComments:function(e){t.navigateTo({url:"/pages/shopping-mall/detail-evaluate/detail-evaluate?id="+e})},addCart:function(){if(0!=this.reserve)return""==this.spec_type_name?(this.togglePopup("bottom","spec"),void(this.addType=1)):void t.request({url:this.url+"controller/shopcontroller/addshoppingcart",method:"post",data:{goodsId:this.detailItem.id,quantity:this.product_num,specificationsId:this.specificationsId,shopId:this.shopItem.shopId},header:{"content-type":"application/x-www-form-urlencoded",token:this.token,port:"app"},success:function(e){200==e.data.code&&t.showToast({title:"添加成功"}),421==e.data.code&&t.navigateTo({url:"/pages/loginPhone/loginPhone"})}});t.showToast({title:"此商品暂时缺货",icon:"none"})},buy:function(){if(0!=this.reserve){""==this.spec_type_name&&(this.addType=2,this.togglePopup("bottom","spec"));var e=[{id:this.detailId,specificationsList:[{specificationsId:this.specificationsId,specificationsNum:this.product_num}]}];t.request({url:this.url+"controller/shopcontroller/addorder",method:"post",data:{goodsList:JSON.stringify(e)},header:{"content-type":"application/x-www-form-urlencoded",token:this.token,port:"app"},success:function(e){200==e.data.code&&t.navigateTo({url:"/pages/confirm-order/confirm-order?num="+e.data.data.orderNum}),421==e.data.code&&t.navigateTo({url:"/pages/loginPhone/loginPhone"})}})}else t.showToast({title:"此商品暂时缺货",icon:"none"})},add:function(){this.product_num++},reduce:function(){this.product_num>1&&this.product_num--},recommendDetails:function(e){t.navigateTo({url:"/pages/shopping-mall/detail/detail?id="+e})},backPreve:function(){t.navigateBack({delta:1})}}};e.default=s}).call(this,o("6e42")["default"],o("0de9")["default"])},e2a9:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=(t._self._c,t.__map(t.recommendItem,function(e,o){var n=t._f("ellipsis")(e.goods_name);return{$orig:t.__get_orig(e),f0:n}}));t.$mp.data=Object.assign({},{$root:{l0:o}})},i=[];o.d(e,"a",function(){return n}),o.d(e,"b",function(){return i})},e42a:function(t,e,o){"use strict";o.r(e);var n=o("7ddf"),i=o.n(n);for(var a in n)"default"!==a&&function(t){o.d(e,t,function(){return n[t]})}(a);e["default"]=i.a}},[["6709","common/runtime","common/vendor"]]]);