(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shop/shop"],{"18bb":function(e,t,o){"use strict";(function(e,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=function(){return o.e("components/uni-popup/uni-popup").then(o.bind(null,"73b7"))},n={components:{uniPopup:c},data:function(){return{show:!1,type:"",token:"",goodsList:[],isCheckedAll:!1,shopChecked:!1,pChecked:!1,totalMoney:0,checkNum:0,isShowEdit:!1,deleteIds:[],cartTotal:0,settlementP:[]}},onLoad:function(){var t=this;e.getStorage({key:"token",success:function(e){t.token=e.data}}),this.init()},methods:{init:function(){var t=this;e.request({url:this.url+"controller/shopcontroller/getshoppingcartlist",data:{pageIndex:1,pageSize:1e3},method:"POST",header:{"content-type":"application/x-www-form-urlencoded",port:"app",token:this.token},success:function(o){if(200==o.data.code){var i=o.data.data.dataList;t.goodsList=o.data.data.dataList;var c=[];i.forEach(function(e,t){e.list.forEach(function(e,t){c.push(e)})}),t.cartTotal=c.length}421==o.data.code&&e.navigateTo({url:"/pages/loginPhone/loginPhone"})}})},cartDetail:function(t){e.navigateTo({url:"/pages/shopping-mall/detail/detail?id="+t})},singleChecked:function(e){var t=this;"undefined"==typeof e.checked?this.$set(e,"checked",!0):e.checked=!e.checked,e.list.forEach(function(o,i){1==e.checked?t.$set(o,"checked",!0):t.$set(o,"checked",!1),o.checked?t.checkNum++:t.checkNum--}),this.totalPrice(),this.cartTotal==this.checkNum?this.isCheckedAll=!0:this.isCheckedAll=!1},selectGoods:function(e,t){var o=!0;"undefined"==typeof e.checked?(this.$set(e,"checked",!0),this.checkNum++):(e.checked=!e.checked,e.checked?this.checkNum++:this.checkNum--);var i=t.list;i.forEach(function(e,t){e.checked||(o=!1)}),o?this.$set(t,"checked",!0):this.$set(t,"checked",!1),this.totalPrice(),this.cartTotal==this.checkNum?this.isCheckedAll=!0:this.isCheckedAll=!1},editP:function(){this.isShowEdit=!this.isShowEdit},toDo:function(){var t=this;if(this.settlementP=[],0!=this.checkNum){this.goodsList.forEach(function(e,o){e.list.forEach(function(e,o){if(e.checked){var i=[{specificationsId:e.specificationsId,specificationsNum:e.quantity}],c={id:e.goodsId,specificationsList:i};t.settlementP.push(c)}})}),e.showLoading({title:"加载中"}),e.request({url:this.url+"controller/shopcontroller/addorder",method:"post",data:{goodsList:JSON.stringify(this.settlementP)},header:{"content-type":"application/x-www-form-urlencoded",token:this.token,port:"app"},success:function(t){200==t.data.code&&(e.navigateTo({url:"/pages/confirm-order/confirm-order?num="+t.data.data.orderNum}),e.hideLoading()),421==t.data.code&&e.navigateTo({url:"/pages/loginPhone/loginPhone"})},fail:function(t){e.hideLoading(),e.showToast({title:"网络异常",icon:"none"})}})}else e.showToast({title:"请选择需要结算的商品",icon:"none"})},isSelectAll:function(){var e=this;this.isCheckedAll=!this.isCheckedAll;var t=this;this.checkNum=0,this.goodsList.forEach(function(o,i){"undefined"==typeof o.checked?t.$set(o,"checked",e.isCheckedAll):o.checked=t.isCheckedAll,o.list.forEach(function(i,c){if(1==o.checked)return e.$set(i,"checked",!0),void(i.checked?e.checkNum++:e.checkNum--);"undefined"==typeof i.checked?t.$set(i,"checked",e.isCheckedAll):i.checked=i.isCheckedAll})}),this.totalPrice()},totalPrice:function(){var e=this;this.totalMoney=0,this.goodsList.forEach(function(t,o){t.list.forEach(function(t,o){t.checked&&(e.totalMoney+=t.goodsPrice*t.quantity)})})},togglePopup:function(t,o){this.type=t,0!=this.checkNum?"tip"===o?this.show=!0:this.$refs[o].open():e.showToast({title:"请选择需要删除的商品",icon:"none"})},cancel:function(t){var o=this,c=this;if("tip"===t)return this.show=!1,void(this.deleteIds=[]);"skip"===t&&(this.goodsList.forEach(function(e,t){e.list.forEach(function(t,n){if(console.log(i(t.checked," at pages\\shop\\shop.vue:311")),t.checked){if(c.deleteIds.length>0)for(var s=0;s<o.deleteIds.length;s++)if(o.deleteIds[s]==e.goodsId)return;c.deleteIds.push(t.goodsId)}})}),e.request({url:this.url+"controller/shopcontroller/delshoppingcartbyidlist",data:{ids:this.deleteIds.toString()},method:"POST",header:{"content-type":"application/x-www-form-urlencoded",port:"app",token:this.token},success:function(t){200==t.data.code?(o.isShowEdit=!0,e.showToast({title:"删除成功"}),o.init(),o.show=!1):console.log(i("请求异常"," at pages\\shop\\shop.vue:339"))}}))},goshop:function(t){e.navigateTo({url:"/pages/shop-command/shop-command?shopId="+t})},backPage:function(){e.navigateBack({delta:1})}}};t.default=n}).call(this,o("6e42")["default"],o("0de9")["default"])},"30d9":function(e,t,o){},3472:function(e,t,o){"use strict";(function(e){o("19df"),o("921b");i(o("66fd"));var t=i(o("7999"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("6e42")["createPage"])},"369b":function(e,t,o){"use strict";var i=function(){var e=this,t=e.$createElement;e._self._c},c=[];o.d(t,"a",function(){return i}),o.d(t,"b",function(){return c})},7999:function(e,t,o){"use strict";o.r(t);var i=o("369b"),c=o("dfcc");for(var n in c)"default"!==n&&function(e){o.d(t,e,function(){return c[e]})}(n);o("e99f");var s=o("2877"),a=Object(s["a"])(c["default"],i["a"],i["b"],!1,null,null,null);t["default"]=a.exports},dfcc:function(e,t,o){"use strict";o.r(t);var i=o("18bb"),c=o.n(i);for(var n in i)"default"!==n&&function(e){o.d(t,e,function(){return i[e]})}(n);t["default"]=c.a},e99f:function(e,t,o){"use strict";var i=o("30d9"),c=o.n(i);c.a}},[["3472","common/runtime","common/vendor"]]]);